/*! The-Noun-Project 2014-09-15 */
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;d=$("#hero-icon"),g=$("#license"),c=$("#header"),j=$("#search"),e=$("#hero-header"),f=$(".list-of-icons"),k=$(".actions .share"),b=$(".actions .download"),i=$(".actions .purchase"),a=$("figcaption cite"),h=84,$(document).ready(function(){return noun.preact.setPerson($(".user-permalink").data("username")),v()}),m=function(a,b,c){return t(c),$.getJSON(a,function(a){var c,d,e;return window.location=a.download_url,c=Math.floor(a.a_la_carte_download),d=Math.floor(a.attribution_download),e=function(){var a,b,e;return a={type:"upsell",style:"full-black",authenticate:!1},e=function(){return $(".close-button").on("click",function(a){return a.preventDefault(),noun.modal.dismiss()}),$(".keep-downloading").on("click",function(a){return a.preventDefault(),noun.modal.dismiss()})},b=function(){var b,d,f;return b=noun.modal.init(a,$("body"),"auto-initialize",f=e,d=!1),noun.preact.preactUpsellModal(c)},0===d%10&&0!==d&&(b(),$(".icon-download-number").html(d),$("#attribution-download").removeClass("hidden")),6===c?(b(),$("#a-la-carte-download").removeClass("hidden"),$("#six-purchase-upsell").removeClass("hidden")):10===c?(b(),$("#a-la-carte-download").removeClass("hidden"),$("#ten-purchase-upsell").removeClass("hidden")):30===c?(b(),$("#a-la-carte-download").removeClass("hidden"),$("#thrity-purchase-upsell").removeClass("hidden")):void 0},b===!0?$(".close-button").on("click",function(a){return a.preventDefault(),noun.modal.dismiss(),e()}):e()}).fail(function(){return"0"})},n=function(a,b){return t(b),$.getJSON(a,function(a){return window.location=a.download_url})},t=function(a){var b,c,d;return c={"A la carte":"Icons downloaded (A la carte)",Attributed:"Icons downloaded (Attributed)",Premium:"Icons downloaded (Premium)","Public domain":"Icons downloaded (Public domain)"},b=c[a],mixpanel.track("Downloaded an icon",{"Download type":a}),"A la carte"===a&&mixpanel.people.track_charge(1.99),d={"Icons downloaded":1},d[b]=1,mixpanel.people.increment(d)},v=function(){var a;return a=$(".share").data("url").split("/"),delete a[5],a[5]=$(".icon.active").data("id"),$(".share").attr("data-url",a.join("/")),$(".purchase").prop("href","/purchase/"+a[5]+"/")},s=function(){var a,b,e,f,g;return g=$(window).height(),a=c.height(),f=j.height(),b=100,e=g-(a+f+b+h),e>650?e=650:350>e&&(e=350),d.height(e),e-=200,d.find(".icon").width(e).height(e),$("hero-template .icon").width(e).height(e)},s(),w=function(){var a,b,c,d,e,f;return e=$("#hero-template"),e.length>0?(f=e.html(),c=e.data("designed-trans"),f.replace("Designed by",c),d=e.data("from-trans"),f.replace("from",d),b=e.data("copy-trans"),f.replace("Copy to clipboard",d),a=e.data("attribute-trans"),f.replace("Attribute as",a),"0"):void 0},w(),$("document").ready(function(){var a,b,c,e,g,h,j,o,p,t,w,y,z,A,B,C;return w=function(a){return $(".list-of-icons li").each(function(b){return b===!0&&a===b.data("id")?(b.addClass("active"),!1):void 0}),"0"},C="//"+noun.url_to_array[2]+"/json_icon_list/"+noun.url_to_array[4],noun.icon_list.scroll_offset="bottom-in-view",noun.icon_list.append_container=$("#results ol"),noun.icon_list.init(C,$(".list-of-icons").next(),$(".list-of-icons ol"),$("#handlebar-template")),j=function(){"0";return noun.icon_list.exhausted===!0?"0":$(".upload-one").removeClass("hidden")},noun.icon_list.callback=j,noun.reloadIconList=function(a){var b;return $("#hero-icon .icon").addClass("reload-url").attr("src","/static/img/fallback-icon.svg/"),b=$('.list-of-icons li[data-id="'+a+'"]').data("page"),C="//"+noun.url_to_array[2]+"/json_reload_list/?q="+q+"&page="+b,$.getJSON(C,function(b){"0";return $.map(b,function(b){return $('li[data-id="'+b.id+'"]').data("icon_url",b.icon_url),parseInt(b.id)===parseInt(a)?($("#hero-icon .icon").attr("src",b.icon_url),$("#hero-icon .icon").removeClass("hidden")):void 0})})},$(window).resize(function(){return s()}),g=function(a){var b,c,d,e;return b=$(".list-of-icons li").length,a=a,c=$(".list-of-icons li.active").index(),e=c+a,e>b||0>e||(d=$(".list-of-icons li:eq("+e+")").find("a")),d.click(),v(),noun.assembleNextUrl()},$(document).on("click","#hero-icon nav a",function(a){var b;return a.preventDefault(),b=$(this).attr("href"),"next"===b?g(1):"prev"===b?g(-1):"0"}),$(document).on("click",".list-of-icons li a",function(b){var c,d,e,f,g;return b.preventDefault(),c=$(".list-of-icons li.active"),g=c.index()+1,d=$(this).parent("li"),f=d.index()+1,e=f>g?"slideInFromRight":"slideInFromLeft",a(d,c),B(d,e),noun.updateActions(d),noun.preact.updateContext(d),noun.preact.preactViewIconEvent(),$("#hero-icon .icon").error(function(){var a,b,c;return a=$("#hero-icon .icon"),c=$("#hero-icon").data("id"),b=$('li[data-id="'+c+'"]').data("page"),noun.icon_list.error(a,c)})}),$(document).on("click",".actions .purchase",function(a){var b;return a.preventDefault(),b=$(this).data("id"),window.location.href="/purchase/"+b+"/"}),$(".actions .purchase").on("click",function(a){return a.preventDefault(),window.location.href="/purchase/"+$("#hero-icon").data("id")+"/"}),a=function(a,b){var c,d,e,g,h,i,j,k;return h=f.outerWidth(),g=f.find("li:nth-child(2)").outerWidth(),d=f.find("li:first-child").width(),j=f.find("li:first-child").outerHeight(!0),b.removeClass("active"),a.addClass("active"),e=a.index()+1,k=$(window).height(),930>k?(i=Math.ceil(e/12),c=-(i-1)*j,$("#results ol").css({top:c}),$(".upload-one").css({top:c})):void 0},B=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C;return a=a,k=a.data("id"),r=a.data("uploader"),t=a.data("uploader-permalink"),p=a.data("location"),u=a.data("year"),j=u,l=a.data("icon_url"),m=a.data("license"),q=a.data("primary-term"),h=a.data("collection-permalink"),g=a.data("collection-name"),i=void 0,B=a.data("sponsor-name"),A=a.data("sponsor-logo"),C=a.data("sponsor-permalink"),"public-domain"===m?(o="Public Domain",n="ui_public-domain"):(i=!0,o="Creative Commons â€“ Attribution (CC BY 3.0)",n="ui_cc"),b=b,d.data("id",k),"true"===$("body").attr("data-can-consume")&&(f=!0),"true"===$("body").attr("data-has-premium")&&(v=!0),"upload-one"===k?(w=a.html(),c=$('<div class="hero-guts"><div class="icon-table '+b+'"><div class="icon-table-cell">'+w+"</div></div></div>")):(x={id:k,uploader_name:r,uploader_permalink:t,location:p,year:u,datetime:j,icon_url:l,license:m,licenseText:o,licenseIcon:n,creativeCommons:i,direction:b,term:q,preview_url:l,consumer:f,premium:v,sponsorName:B,sponsorLogo:A,sponsorPermalink:C,collectionsPermalink:h,collectionsName:g},""===B&&(x.no_sponsor=!0),z=$("#hero-template").html(),e=Handlebars.compile(z),c=e(x)),y=d.find(".hero-guts"),y.addClass("slideOut "+b),d.append(c),s(),setTimeout(function(){return y.remove()},250),$("html,body").stop().animate({scrollTop:0},500),!1},A=function(a){var b,c,d,e,f;return a=a?a:$("#results .icon.active"),d=a.data("id"),$("body").data("authentication")===!0&&(b=!0),$("body").data("can-consume")===!0&&(c=!0),$("body").data("has-premium")===!0&&(f=!0),"public-domain"===a.data("license")?($("#download").removeClass("disable"),$("#premium-download").addClass("disable"),$("#purchase-download").addClass("disable"),$("#upgrade").addClass("disable")):c?($("#download").addClass("disable"),$("#premium-download").removeClass("disable"),$("#purchase-download").addClass("disable"),$("#upgrade").addClass("disable")):($("#premium-download").addClass("disable"),f?($("#purchase-download").removeClass("disable"),$("#download").addClass("disable"),$("#upgrade").removeClass("disable")):($("#purchase-download").addClass("disable"),$("#download").removeClass("disable"),$("#upgrade").addClass("disable"))),e=a.find("img").attr("src"),k.data("url",e),i.data("id",d),v()},noun.updateActions=A,h=function(){var a;return $(".list-of-icons").removeClass("initial-load"),$("#results .icon").length>2&&$("#hero-icon nav").removeClass("initial-load"),a=$("#hero-icon").data("id"),$(".list-of-icons li:not(.initial-icon)").each(function(){return $(this).data("id")===a?($(this).addClass("active"),$(".initial-icon").remove(),!1):void 0}),"0"},noun.icon_list.on_finish=h,e={type:"download",style:"full-blur",authenticate:!0},z={type:"share",style:"full-blur",authenticate:!1},o=function(){return $(".close-button").on("click",function(a){return a.preventDefault(),noun.modal.dismiss()})},y=noun.modal.init(z,$("body"),"click",t=o,b=!1,"button.share"),p=function(a){var b,c,d,e,f;return d=$("#hero-icon").data("id"),e=$(".term").data("term"),$(".close-button").on("click",function(a){return a.preventDefault(),noun.modal.dismiss()}),"public-domain"===$('.list-of-icons li[data-id="'+d+'"]').data("license")?(n("/download/"+d+"/"+"?attribute=true","Public domain"),$(".download-options").addClass("hidden"),$(".download-modal .publicDomainMessage").removeClass("hidden")):"cc-by-download"===a?(u(),x(d),$(".download-options").addClass("hidden"),$(".do-you-agree").removeClass("hidden")):$("body").data("can-consume")===!0?(n("/download/"+d+"/","Premium"),l(),$(".download-options").addClass("hidden"),r()):setTimeout(function(){return $(".upgrade").removeClass("hidden")},2500),c=$("#html-attribution"),c.click(function(a){return a.preventDefault(),c.zclip({path:"/static/js/vendor/ZeroClipboard.swf",copy:$(".digital-attribution").text(),afterCopy:function(){}})}),f=$("#text-attribution"),f.click(function(a){return a.preventDefault(),f.zclip({path:"/static/js/vendor/ZeroClipboard.swf",copy:$(".print-attribution").text(),afterCopy:function(){}})}),$(".modal .purchase").on("click",function(a){return $(this).off("click"),a.preventDefault(),window.location.href="/purchase/"+d+"/"}),$(".modal .consume").on("click",function(){return $(this).off("click"),n("/download/"+d,"Attributed")}),$(".modal .attribute").on("click",function(a){return $(this).off("click"),a.preventDefault(),$(".download-options").addClass("hidden"),$(".do-you-agree").removeClass("hidden")}),$(".modal .i-agree").on("click",function(a){return $(this).off("click"),a.preventDefault(),m("/download/"+d+"/?attribute=true",!0,"Attributed"),$(".do-you-agree").addClass("hidden"),$(".downloading").removeClass("hidden"),setTimeout(function(){return $(".downloading").addClass("hidden"),$(".how-to-attribute").removeClass("hidden"),setTimeout(function(){return $(".upgrade").removeClass("hidden")},2500)},3e3)}),b=function(a,b){var c,d,e;return c="/settings/plans",e="?next_url=/term/"+a+"/"+b+"?action=download",d=c+e,$(".modal .upgrade a").attr("href",d)},b(e,d)},c=noun.modal.init(e,$(document),"click",t=p,b=!0,".trigger-modal.download"),$("body").bind("keydown",function(a){var b,c,d,e;if(c=37,e=38,d=39,b=40,!$("body").hasClass("blur"))switch(a.keyCode){case c:return g(-1)&&a.preventDefault();case d:return g(1)&&a.preventDefault();case e:return g(-12)&&a.preventDefault();case b:return g(12)&&a.preventDefault()}}),$(".list-of-icons").waypoint(function(a){return"down"===a?($("#results ol").css({top:0}),$(".upload-one").css({top:0})):void 0},{offset:"80%"})}),noun.modal.reset_download=function(){return $(".modal .do-you-agree").addClass("hidden"),$(".modal .downloading").addClass("hidden"),$(".modal .how-to-attribute").addClass("hidden"),$(".modal .publicDomainMessage").addClass("hidden"),$(".modal .download-options").removeClass("hidden")},r=function(){return $(".download-modal .downloading").removeClass("hidden"),setTimeout(function(){return noun.modal.dismiss()},3e3)},l=function(){var a,b,c;return a=$("#licenses-available").attr("data-licenses-available"),b=$("#licenses-available").attr("data-licenses-trans"),c=a-1,0>=c&&(c=0,$("body").attr("data-can-consume","false")),$("#premium-download").attr("data-licenses-available",c),$("#premium-download .count").text(c),$("#licenses-available").attr("data-licenses-available",c),$("#licenses-available").text(c+" "+b),$("#organization-drawer .current-organization").find(".licenses-available").attr("data-licenses-available",c).text(c+" "+b),$(".org-context-navigation.active .licenses-available").text(c+" "+b),noun.updateActions()},x=function(a){var b;return b="/purchase/"+a+"/",$(".download-modal .how-to-attribute .purchase").attr("href",b)},u=function(){var a,b;return b=$(".hero-guts:not(.slideOut) .print-attribution").text(),a=$(".hero-guts:not(.slideOut) .attribution").html(),$(".download-modal .print-attribution").text(b),$(".download-modal .digital-attribution").text(a)},q=noun.url_to_array[6],void 0!==q&&(-1!==q.indexOf("action=purchase")?(p=q.replace("action=purchase&",""),o=noun.url_to_array[5],m("/download/"+o+"/"+p,!1,"A la carte")):-1!==q.indexOf("action=download")&&(p=q.replace("action=download&",""),o=noun.url_to_array[5],n("/download/"+o+"/","A la carte"),l(),$(".download-options").addClass("hidden"),r())),$("body").on("click",".how-to-attribute-trigger",function(a){return a.preventDefault(),u(),$(".modal.download-modal").removeClass("hidden").addClass("visible"),$(".modal .do-you-agree").addClass("hidden"),$(".modal .downloading").addClass("hidden"),$(".modal .publicDomainMessage").addClass("hidden"),$(".modal .download-options").addClass("hidden"),$(".modal .how-to-attribute").removeClass("hidden"),$(".close-button").on("click",function(a){return a.preventDefault(),noun.modal.dismiss()}),"0"})}).call(this);